generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Product {
  id              Int               @id @default(autoincrement())
  categoryId      Int
  name            String            @unique @db.VarChar(255)
  longDesc        String?           @db.LongText()
  shortDesc       String?           @db.VarChar(512)
  createdAt       DateTime          @default(now()) @db.Timestamp(6)
  updatedAt       DateTime          @default(now()) @db.Timestamp(6)
  // relations
  Attribute_value Attribute_value[]
  Category        Category          @relation(fields: [categoryId], references: [id])
  Media           Media[]
}

model Account {
  email    String @id @db.VarChar(255)
  username String @unique @db.VarChar(255)
  password String @db.VarChar(512)
}

model Attribute {
  id              Int               @id @default(autoincrement())
  name            String            @db.VarChar(255)
  // relations
  Attribute_value Attribute_value[]
}

model Attribute_value {
  Product     Product   @relation(fields: [productId], references: [id])
  productId   Int
  Attribute   Attribute @relation(fields: [attributeId], references: [id])
  attributeId Int
  value       String    @db.VarChar(255)

  @@id([productId, attributeId])
}

model Category {
  id      Int       @id @default(autoincrement())
  name    String    @db.VarChar(255)
  Product Product[]
}

model Media {
  url        String   @id @db.VarChar(255)
  name       String   @db.VarChar(255)
  uploadedAt DateTime @default(now()) @db.Timestamp(6)
  // relations
  Banner     Banner?
  Product    Product? @relation(fields: [productId], references: [id])
  productId  Int?
}

model Banner {
  id    Int    @id @default(autoincrement())
  // relations
  Media Media  @relation(fields: [url], references: [url])
  url   String @unique @db.VarChar(255)
}

model Setting {
  id         Int     @id @default(autoincrement())
  address    String? @db.VarChar(255)
  logo       String? @db.VarChar(255)
  siteTitle  String? @db.VarChar(255)
  adminEmail String? @db.VarChar(255)
}
